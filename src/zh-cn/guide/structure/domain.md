# 领域

领域或领域模型是使项目独特的原因。考虑到正在解决的问题的需求和术语
（问题上下文），您构建了一个由实体、它们的关系以及操作这些实体的逻辑组成的抽象。
为了专注于问题的复杂部分，领域理想情况下与系统的基础设施部分分离
（即如何将数据保存到数据库、如何形成 HTTP 响应等）。

> [!NOTE]
> 这种隔离适用于复杂系统。如果您项目领域基本上是一组记录的创建/读取/更新/删除，
> 没有太多复杂的逻辑，那么对简单问题应用复杂的解决方案是没有意义的。
> 下面的领域设计的各个概念可以单独应用，因此即使您的项目不是很复杂，也请务必检查这些概念。

## 限界上下文

构建一个本身不太复杂的解决多个问题的模型几乎是不可能的。因此，
将领域划分为几个用例并为每个用例设置单独的模型是一个很好的做法。
这种分离的模型被称为 "限界上下文"。

## 构建块

在描述领域模型时，通常会使用各种构建块。并非必须使用所有构建块。

### 实体

实体是唯一可识别的对象，例如用户、产品、付款等。比较它们时，您检查的是 ID，
而不是属性值。如果有两个具有不同属性但具有相同 ID 的对象，它们被认为是同一个东西。

### 值对象

值对象通过其特征描述对象。例如，由值和货币组成的价格。
比较此类对象时，您检查的是实际值。如果它们匹配，则认为对象是相同的。

### 聚合

聚合是一组领域对象，例如实体和值对象以及可以被视为单个单元的其他数据。
它通常代表领域模型中的复合对象，例如商店订单或人事档案。

聚合的组件之一称为根。根将聚合标识为一个整体，应该用于访问它。

### 领域事件

聚合在处理过程中可能会引发事件。例如，当订单被确认时，将引发 `OrderConfirmed` 事件，
以便系统的其他部分可以对此做出反应。

### 数据传输对象

数据传输对象或 DTO 是一个唯一目的是按原样保存数据的对象。
它通常用于在不同服务之间传递数据。

### 服务

服务是在领域模型上下文中包含独立操作的类。请参阅 "[服务组件](service.md)"。

### 仓储

仓储的任务是抽象化如何获取领域对象。这些通常分为两部分：位于领域层的接口和位于基础设施层的实现。
通过这种方式，领域不关心如何获取和保存数据，而是可以专注于复杂的业务逻辑。

仓储通常作为服务实现。

### 实例化构建块

实体、值对象、聚合和领域事件不是服务，不应通过 DI 容器实例化。
对它们使用 `new` 是正确的方法。

## 参考资料

- [Martin Fowler 的 BoundedContext](https://martinfowler.com/bliki/BoundedContext.html)
- [Martin Fowler 的 ValueObject](https://martinfowler.com/bliki/ValueObject.html)
- [Marting Fowler 的 Aggregate](https://martinfowler.com/bliki/DDD_Aggregate.html)

